<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Marp PWA - Markdown to Slide Converter</title>
  <link rel="manifest" href="manifest_fixed.json">
  <link rel="stylesheet" href="style.css">
  <!-- CodeMirror CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/default.min.css">
</head>
<body>
  <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ -->
  <div id="loading" class="loading" style="display:none;">
    <div class="loading-spinner"></div>
    <div>å‡¦ç†ä¸­...</div>
  </div>
  <!-- ã‚¨ãƒ©ãƒ¼è¡¨ç¤º -->
  <div id="error-display" class="error-display" style="display:none;">
    <div class="error-content">
      <h2>âš ï¸ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</h2>
      <div id="error-message"></div>
      <button id="error-close" class="btn btn--primary">é–‰ã˜ã‚‹</button>
    </div>
  </div>
  <!-- æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
  <div id="success-display" class="status-message status-message--success" style="display:none;">
    <span id="success-message"></span>
    <button id="success-close" class="btn btn--sm">Ã—</button>
  </div>
  <!-- ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒª -->
  <div class="app">
    <header class="app-header">
      <div class="header-content">
        <span class="app-title">Marp PWA - Markdown to Slide Converter</span>
        <div class="header-actions">
          <button id="save-md-btn" class="btn btn--outline" title="Markdownã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰">ğŸ’¾ ä¿å­˜</button>
          <button id="export-pdf" class="btn btn--outline" title="PDFå‡ºåŠ›">ğŸ“„ PDF</button>
          <button id="export-pptx" class="btn btn--outline" title="PPTXå‡ºåŠ›">ğŸ“Š PPTX</button>
          <button id="export-html" class="btn btn--outline" title="HTMLå‡ºåŠ›">ğŸŒ HTML</button>
          <button id="settings-btn" class="btn btn--outline" title="è¨­å®š">âš™ï¸ è¨­å®š</button>
          <button id="preview-toggle" class="btn btn--outline" title="ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼åˆ‡æ›¿">ğŸ–¥ï¸/ğŸ“„</button>
        </div>
      </div>
    </header>
    <main class="app-main">
      <section class="editor-panel">
        <div class="panel-header">
          <h2>Markdownå…¥åŠ›</h2>
          <div class="editor-status">
            <span id="char-count">0 æ–‡å­—</span>
            <span id="save-status">æœªä¿å­˜</span>
          </div>
        </div>
        <div class="editor-container">
          <textarea id="markdown-editor" class="form-control" spellcheck="false"></textarea>
        </div>
      </section>
      <section class="preview-panel">
        <div class="panel-header">
          <h2 id="preview-title">ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h2>
          <div class="preview-controls">
            <button id="prev-slide" class="btn btn--sm" title="å‰ã®ã‚¹ãƒ©ã‚¤ãƒ‰">â—€</button>
            <span id="slide-counter">1 / 1</span>
            <button id="next-slide" class="btn btn--sm" title="æ¬¡ã®ã‚¹ãƒ©ã‚¤ãƒ‰">â–¶</button>
          </div>
        </div>
        <div class="preview-container">
          <div id="preview-content" class="preview-content">
            <p>ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹Markdownã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>
          </div>
        </div>
      </section>
    </main>
    <!-- è¨­å®šãƒ‘ãƒãƒ« -->
    <div id="settings-panel" class="modal hidden">
      <div class="modal-content settings-content" onclick="event.stopPropagation();">
        <div class="modal-header">
          <h3>è¨­å®š</h3>
          <button id="settings-close" class="btn btn--sm">Ã—</button>
        </div>
        <div class="modal-body">
          <form id="settings-form">
            <div class="form-group">
              <label class="form-label" for="theme-select">ãƒ†ãƒ¼ãƒ</label>
              <select id="theme-select" class="form-control">
                <option value="default">Default</option>
                <option value="gaia">Gaia</option>
                <option value="uncover">Uncover</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º</label>
              <div>
                <label><input type="radio" name="font-size" value="small" id="font-size-small"> å°</label>
                <label><input type="radio" name="font-size" value="medium" id="font-size-medium" checked> ä¸­</label>
                <label><input type="radio" name="font-size" value="large" id="font-size-large"> å¤§</label>
                <label><input type="radio" name="font-size" value="custom" id="font-size-custom"> ã‚«ã‚¹ã‚¿ãƒ </label>
                <input type="number" id="custom-font-size" class="form-control" min="8" max="64" step="1" value="16" style="width:80px;display:inline-block;" disabled> <span>px</span>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label" for="slide-ratio-select">ã‚¹ãƒ©ã‚¤ãƒ‰æ¯”ç‡</label>
              <select id="slide-ratio-select" class="form-control">
                <option value="16:9">16:9</option>
                <option value="4:3">4:3</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label" for="background-color">èƒŒæ™¯è‰²</label>
              <input type="color" id="background-color" class="form-control" value="#ffffff">
            </div>
            <div class="form-group">
              <label class="form-label" for="text-color">æ–‡å­—è‰²</label>
              <input type="color" id="text-color" class="form-control" value="#000000">
            </div>
            <div class="form-group" style="display:flex;gap:8px;">
              <button type="button" id="reset-settings" class="btn btn--secondary">ãƒªã‚»ãƒƒãƒˆ</button>
              <button type="button" id="apply-settings" class="btn btn--primary">é©ç”¨</button>
            </div>
          </form>
        </div>
      </div>
    </div>
    <!-- è¨­å®šãƒ‘ãƒãƒ«ã®èƒŒæ™¯ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹ -->
    <div class="settings-overlay modal hidden" id="settings-overlay"></div>
  </div>
  <!-- å¿…é ˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªCDN -->
  <script src="https://cdn.jsdelivr.net/npm/@marp-team/marp-core@4/lib/browser.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/markdown/markdown.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/gitbrent/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
  <!-- ã‚¢ãƒ—ãƒªæœ¬ä½“ -->
  <script src="app_fixed.js"></script>
  <!-- Service Workerç™»éŒ² -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('sw_fixed.js').then(function(reg) {
          console.log('Service Worker registered:', reg);
        }).catch(function(err) {
          console.warn('Service Worker registration failed:', err);
        });
      });
    }
  </script>
</body>
</html>
